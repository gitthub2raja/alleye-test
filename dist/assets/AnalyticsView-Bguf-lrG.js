import{g as z,r as u,j as r,a as b,C as g}from"./index-B1M48IIc.js";import{f as Z}from"./xapiLrsClient-D85D4vVW.js";import{r as F,a as K,b as V,d as X,u as H,c as J,e as ee,f as k,s as te,Z as re,L as A,g as U,P as ae,h as se,p as E,i as T,j as ne,k as ie,l as oe,m as le,R as Q,T as W}from"./CartesianChart-CO1LtEG5.js";import{A as ce,a as R}from"./AreaChart-ByFbb1p9.js";import{C as de,L as ue}from"./CartesianGrid-BU5XHtoG.js";import{X as me}from"./XAxis-DF_0Vgkl.js";import{Y as xe}from"./YAxis-CJyeSg_n.js";import{s as fe,a as pe,R as ye,P as ve,b as ge,c as he}from"./RadarChart-CvZzi3I1.js";import"./ActivePoints-BaaZkCC_.js";import"./getRadiusAndStrokeWidthFromDot-DKg59sKC.js";import"./PolarChart-BD4rHRBZ.js";var w={},P={},L;function je(){return L||(L=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(a,s){if(a.length===0)return;let i=a[0],n=s(i);for(let d=1;d<a.length;d++){const p=a[d],f=s(p);f>n&&(n=f,i=p)}return i}e.maxBy=t})(P)),P}var I;function be(){return I||(I=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=je(),a=K(),s=F();function i(n,d){if(n!=null)return t.maxBy(Array.from(n),s.iteratee(d??a.identity))}e.maxBy=i})(w)),w}var O,M;function ke(){return M||(M=1,O=be().maxBy),O}var we=ke();const Pe=z(we);var C={},N={},D;function Oe(){return D||(D=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});function t(a,s){if(a.length===0)return;let i=a[0],n=s(i);for(let d=1;d<a.length;d++){const p=a[d],f=s(p);f<n&&(n=f,i=p)}return i}e.minBy=t})(N)),N}var $;function Ce(){return $||($=1,(function(e){Object.defineProperty(e,Symbol.toStringTag,{value:"Module"});const t=Oe(),a=K(),s=F();function i(n,d){if(n!=null)return t.minBy(Array.from(n),s.iteratee(d??a.identity))}e.minBy=i})(C)),C}var B,_;function Ne(){return _||(_=1,B=Ce().minBy),B}var Be=Ne();const Se=z(Be);var Ae=["cx","cy","angle","axisLine"],Ee=["angle","tickFormatter","stroke","tick"];function j(){return j=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var s in a)({}).hasOwnProperty.call(a,s)&&(e[s]=a[s])}return e},j.apply(null,arguments)}function q(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(i){return Object.getOwnPropertyDescriptor(e,i).enumerable})),a.push.apply(a,s)}return a}function y(e){for(var t=1;t<arguments.length;t++){var a=arguments[t]!=null?arguments[t]:{};t%2?q(Object(a),!0).forEach(function(s){Te(e,s,a[s])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):q(Object(a)).forEach(function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(a,s))})}return e}function Te(e,t,a){return(t=Re(t))in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function Re(e){var t=Le(e,"string");return typeof t=="symbol"?t:t+""}function Le(e,t){if(typeof e!="object"||!e)return e;var a=e[Symbol.toPrimitive];if(a!==void 0){var s=a.call(e,t);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Y(e,t){if(e==null)return{};var a,s,i=Ie(e,t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);for(s=0;s<n.length;s++)a=n[s],t.indexOf(a)===-1&&{}.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}function Ie(e,t){if(e==null)return{};var a={};for(var s in e)if({}.hasOwnProperty.call(e,s)){if(t.indexOf(s)!==-1)continue;a[s]=e[s]}return a}var Me="radiusAxis";function De(e){var t=H();return u.useEffect(()=>(t(J(e)),()=>{t(ee(e))})),null}var $e=(e,t,a,s)=>{var{coordinate:i}=e;return E(a,s,i,t)},_e=e=>{var t;switch(e){case"left":t="end";break;case"right":t="start";break;default:t="middle";break}return t},qe=(e,t,a,s)=>{var i=Pe(s,d=>d.coordinate||0),n=Se(s,d=>d.coordinate||0);return{cx:t,cy:a,startAngle:e,endAngle:e,innerRadius:(n==null?void 0:n.coordinate)||0,outerRadius:(i==null?void 0:i.coordinate)||0,clockWise:!1}},ze=(e,t)=>{var{cx:a,cy:s,angle:i,axisLine:n}=e,d=Y(e,Ae),p=t.reduce((o,l)=>[Math.min(o[0],l.coordinate),Math.max(o[1],l.coordinate)],[1/0,-1/0]),f=E(a,s,p[0],i),v=E(a,s,p[1],i),c=y(y(y({},T(d)),{},{fill:"none"},T(n)),{},{x1:f.x,y1:f.y,x2:v.x,y2:v.y});return u.createElement("line",j({className:"recharts-polar-radius-axis-line"},c))},Fe=(e,t,a)=>{var s;return u.isValidElement(e)?s=u.cloneElement(e,t):typeof e=="function"?s=e(t):s=u.createElement(le,j({},t,{className:"recharts-polar-radius-axis-tick-value"}),a),s},Ke=(e,t)=>{var{angle:a,tickFormatter:s,stroke:i,tick:n}=e,d=Y(e,Ee),p=_e(e.orientation),f=T(d),v=ne(n),c=t.map((o,l)=>{var x=$e(o,e.angle,e.cx,e.cy),m=y(y(y(y({textAnchor:p,transform:"rotate(".concat(90-a,", ").concat(x.x,", ").concat(x.y,")")},f),{},{stroke:"none",fill:i},v),{},{index:l},x),{},{payload:o});return u.createElement(A,j({className:U("recharts-polar-radius-axis-tick",oe(n)),key:"tick-".concat(o.coordinate)},ie(e,o,l)),Fe(n,m,s?s(o.value,l):o.value))});return u.createElement(A,{className:"recharts-polar-radius-axis-ticks"},c)},Ue=e=>{var{radiusAxisId:t}=e,a=k(te),s=k(f=>fe(f,"radiusAxis",t)),i=k(f=>pe(f,"radiusAxis",t,!1));if(a==null||!i||!i.length||s==null)return null;var n=y(y(y({},e),{},{scale:s},a),{},{radius:a.outerRadius}),{tick:d,axisLine:p}=n;return u.createElement(re,{zIndex:n.zIndex},u.createElement(A,{className:U("recharts-polar-radius-axis",Me,n.className)},p&&ze(n,i),d&&Ke(n,i),u.createElement(ae,qe(n.angle,n.cx,n.cy,i),u.createElement(se,{label:n.label}),n.children)))};function G(e){var t=V(e,X);return u.createElement(u.Fragment,null,u.createElement(De,{domain:t.domain,id:t.radiusAxisId,scale:t.scale,type:t.type,dataKey:t.dataKey,unit:void 0,name:t.name,allowDuplicatedCategory:t.allowDuplicatedCategory,allowDataOverflow:t.allowDataOverflow,reversed:t.reversed,includeHidden:t.includeHidden,allowDecimals:t.allowDecimals,ticks:t.ticks,tickCount:t.tickCount,tick:t.tick}),u.createElement(Ue,t))}G.displayName="PolarRadiusAxis";const Qe=({active:e,payload:t,label:a})=>e&&t&&t.length?r.jsxs("div",{className:"bg-sidebar p-2 border border-border rounded-md shadow-lg text-xs",children:[r.jsx("p",{className:"font-bold text-text-main",children:a}),t.map((s,i)=>r.jsx("p",{style:{color:s.stroke},children:`${s.name}: ${s.value}`},i))]}):null,We=({data:e,title:t})=>r.jsxs(b,{children:[r.jsx("h3",{className:"text-lg font-semibold text-text-main mb-4",children:t}),r.jsx("div",{style:{width:"100%",height:300},children:r.jsx(Q,{children:r.jsxs(ce,{data:e,margin:{top:10,right:30,left:0,bottom:0},children:[r.jsxs("defs",{children:[r.jsxs("linearGradient",{id:"colorLogins",x1:"0",y1:"0",x2:"0",y2:"1",children:[r.jsx("stop",{offset:"5%",stopColor:"#8884d8",stopOpacity:.8}),r.jsx("stop",{offset:"95%",stopColor:"#8884d8",stopOpacity:0})]}),r.jsxs("linearGradient",{id:"colorCompletions",x1:"0",y1:"0",x2:"0",y2:"1",children:[r.jsx("stop",{offset:"5%",stopColor:"#82ca9d",stopOpacity:.8}),r.jsx("stop",{offset:"95%",stopColor:"#82ca9d",stopOpacity:0})]})]}),r.jsx(de,{strokeDasharray:"3 3",stroke:"var(--border-color)"}),r.jsx(me,{dataKey:"date",tick:{fill:"var(--text-secondary-color)",fontSize:12}}),r.jsx(xe,{tick:{fill:"var(--text-secondary-color)",fontSize:12}}),r.jsx(W,{content:r.jsx(Qe,{})}),r.jsx(ue,{wrapperStyle:{fontSize:"14px"}}),r.jsx(R,{type:"monotone",dataKey:"logins",name:"Engagements",stroke:"#8884d8",fillOpacity:1,fill:"url(#colorLogins)"}),r.jsx(R,{type:"monotone",dataKey:"completions",name:"Completions",stroke:"#82ca9d",fillOpacity:1,fill:"url(#colorCompletions)"})]})})})]}),Ye=({data:e,title:t})=>r.jsxs(b,{children:[r.jsx("h3",{className:"text-lg font-semibold text-text-main mb-4",children:t}),r.jsx("div",{className:"max-h-[350px] overflow-y-auto space-y-4 pr-2 custom-scrollbar",children:e.length>0?e.map(a=>{const s=a.status==="completed",i=a.status==="in-progress";let n;return s?a.isQuiz?n=a.value>=70?"bg-green-500":"bg-orange-500":n="bg-green-500":n="bg-yellow-500",r.jsxs("div",{children:[r.jsxs("div",{className:"flex justify-between items-center mb-1 text-sm",children:[r.jsx("span",{className:"font-semibold text-text-main truncate pr-4",children:a.title}),r.jsx("span",{className:`font-mono font-semibold ${s?"text-text-main":"text-yellow-400"}`,children:s?a.isQuiz?`${a.value}%`:"Done":"In Progress"})]}),r.jsx("div",{className:"w-full bg-sidebar rounded-full h-2",children:r.jsx("div",{className:`h-2 rounded-full transition-all duration-300 ${n}`,style:{width:`${i?50:a.value}%`}})})]},a.id)}):r.jsx("div",{className:"flex items-center justify-center h-full min-h-[200px]",children:r.jsx("p",{className:"text-text-secondary text-center",children:"No learning activity to display yet."})})})]}),Ge=e=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24",strokeWidth:1.5,stroke:"currentColor",...e,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),Ze=e=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24",strokeWidth:1.5,stroke:"currentColor",...e,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.48 3.499a.562.562 0 011.04 0l2.125 5.111a.563.563 0 00.475.31h5.404a.562.562 0 01.321.988l-4.204 3.602a.563.563 0 00-.182.557l1.285 5.385a.562.562 0 01-.84.61l-4.725-2.885a.563.563 0 00-.586 0L6.982 20.54a.562.562 0 01-.84-.61l1.285-5.386a.562.562 0 00-.182-.557l-4.204-3.602a.562.562 0 01.321-.988h5.404a.563.563 0 00.475-.31l2.125-5.11z"})}),Ve=e=>r.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24",strokeWidth:1.5,stroke:"currentColor",...e,children:r.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 11-18 0 9 9 0 0118 0z"})}),S=({title:e,value:t,icon:a})=>r.jsxs(b,{className:"flex items-center p-4",children:[r.jsx("div",{className:"p-3 mr-4 bg-sidebar-accent rounded-lg",children:a}),r.jsxs("div",{children:[r.jsx("p",{className:"text-sm text-text-secondary",children:e}),r.jsx("p",{className:"text-2xl font-bold text-text-main",children:t})]})]}),Xe=({active:e,payload:t})=>e&&t&&t.length?r.jsxs("div",{className:"bg-sidebar p-2 border border-border rounded-md shadow-lg text-xs",children:[r.jsx("p",{className:"font-bold text-text-main",children:`${t[0].payload.subject}`}),r.jsx("p",{style:{color:t[0].color||t[0].fill},children:`Avg. Score: ${t[0].value.toFixed(1)}%`})]}):null,He=({data:e})=>r.jsxs(b,{children:[r.jsx("h3",{className:"text-lg font-semibold text-text-main mb-4",children:"Skill Proficiency"}),r.jsx("div",{style:{width:"100%",height:250},children:e.length>2?r.jsx(Q,{children:r.jsxs(ye,{cx:"50%",cy:"50%",outerRadius:"80%",data:e,children:[r.jsx(ve,{stroke:"var(--border-color)"}),r.jsx(ge,{dataKey:"subject",tick:{fill:"var(--text-secondary-color)",fontSize:12}}),r.jsx(G,{angle:30,domain:[0,100],tick:!1,axisLine:!1}),r.jsx(he,{name:"Score",dataKey:"score",stroke:"var(--primary-color)",fill:"var(--primary-color)",fillOpacity:.6}),r.jsx(W,{content:r.jsx(Xe,{})})]})}):r.jsx("div",{className:"flex items-center justify-center h-full text-center text-text-secondary text-sm p-4",children:r.jsx("p",{children:"Complete quizzes in at least 3 different categories to see your skill proficiency chart."})})})]}),dt=({user:e,allContent:t})=>{const[a,s]=u.useState([]),[i,n]=u.useState(!0);u.useEffect(()=>{(async()=>{n(!0);const o=await Z({agent:e,limit:1e3});s(o),n(!1)})()},[e]);const d=u.useMemo(()=>{const c=new Set(Object.entries(e.progress||{}).filter(([,m])=>m.status==="completed").map(([m])=>parseInt(m,10))),o=Object.values(e.progress||{}).map(m=>m.score).filter(m=>m!=null),l=o.length>0?o.reduce((m,h)=>m+h,0)/o.length:0,x=t.filter(m=>c.has(m.id)).reduce((m,h)=>m+(h.duration_sec||0),0);return{completed:c.size,avgScore:Math.round(l),learningTime:Math.floor(x/60)}},[e.progress,t]),p=u.useMemo(()=>{const c={};return a.forEach(o=>{const l=new Date(o.timestamp).toLocaleDateString("en-US",{month:"short",day:"numeric"});c[l]||(c[l]={date:l,logins:0,completions:0}),o.verb.id.includes("launched")&&c[l].logins++,o.verb.id.includes("completed")&&c[l].completions++}),Object.values(c).sort((o,l)=>new Date(o.date).getTime()-new Date(l.date).getTime()).slice(-30)},[a]),f=u.useMemo(()=>{const c={},o=[g.QUIZ,g.VIDEO_QUIZ,g.CYBER_SECURITY_TRAINING];return t.forEach(l=>{var m;const x=(m=e.progress)==null?void 0:m[l.id];(x==null?void 0:x.status)==="completed"&&x.score!==void 0&&o.includes(l.type)&&l.category&&(c[l.category]||(c[l.category]={scores:[],count:0}),c[l.category].scores.push(x.score),c[l.category].count++)}),Object.entries(c).map(([l,x])=>({subject:l,score:x.scores.reduce((m,h)=>m+h,0)/x.count,fullMark:100})).slice(0,6)},[e.progress,t]),v=u.useMemo(()=>t.map(c=>{var o;return{content:c,progress:(o=e.progress)==null?void 0:o[c.id]}}).filter(c=>c.progress&&(c.progress.status==="in-progress"||c.progress.status==="completed")).map(c=>{const{content:o,progress:l}=c;let x=0;return(l==null?void 0:l.status)==="completed"&&(x=l.score!==void 0?l.score:100),{id:o.id,title:o.title,status:l.status,value:x,isQuiz:[g.QUIZ,g.VIDEO_QUIZ,g.CYBER_SECURITY_TRAINING].includes(o.type)}}).sort((c,o)=>(c.status==="in-progress"?-1:1)-(o.status==="in-progress"?-1:1)||o.id-c.id).slice(0,10),[e.progress,t]);return i?r.jsx("div",{children:"Loading your analytics..."}):r.jsxs("div",{className:"animate-fade-in space-y-6",children:[r.jsx("h1",{className:"text-3xl font-bold",children:"My Analytics"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[r.jsx(S,{title:"Courses Completed",value:d.completed,icon:r.jsx(Ge,{className:"w-6 h-6 text-green-400"})}),r.jsx(S,{title:"Average Score",value:`${d.avgScore}%`,icon:r.jsx(Ze,{className:"w-6 h-6 text-yellow-400"})}),r.jsx(S,{title:"Total Learning Time",value:`${d.learningTime} min`,icon:r.jsx(Ve,{className:"w-6 h-6 text-blue-400"})})]}),r.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[r.jsx("div",{className:"lg:col-span-2",children:r.jsx(We,{data:p,title:"My Activity (Last 30 entries)"})}),r.jsx("div",{className:"lg:col-span-1",children:r.jsx(He,{data:f})})]}),r.jsx("div",{children:r.jsx(Ye,{data:v,title:"Learning Focus"})})]})};export{dt as default};
