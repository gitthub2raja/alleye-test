var H=Object.defineProperty;var I=t=>{throw TypeError(t)};var F=(t,i,e)=>i in t?H(t,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[i]=e;var k=(t,i,e)=>F(t,typeof i!="symbol"?i+"":i,e),N=(t,i,e)=>i.has(t)||I("Cannot "+e);var A=(t,i,e)=>(N(t,i,"read from private field"),e?e.call(t):i.get(t)),$=(t,i,e)=>i.has(t)?I("Cannot add the same private member more than once"):i instanceof WeakSet?i.add(t):i.set(t,e),C=(t,i,e,s)=>(N(t,i,"write to private field"),s?s.call(t,e):i.set(t,e),e);import{_ as W,R as U}from"./index-CXuIkrQK.js";import{M as j,C as P}from"./mixin-C_e69MQf.js";var _;class S extends j(P){constructor(){super(...arguments);$(this,_)}attributeChangedCallback(e,s,n){e!=="src"&&super.attributeChangedCallback(e,s,n),e==="src"&&s!=n&&this.load()}async _initThumbnails(e){const s=async(d,p)=>{const g=[],m=e.timescale||1,w=e.startNumber||1,M=e.presentationTimeOffset?e.presentationTimeOffset/m:0,h=e.segmentDuration;for(let v=0;v<d;v++){const y=q({thIndex:v,thduration:p,ttiles:d,tduration:h,startNumber:w,pto:M}),R=y+p,b=new Promise((E,a)=>{this.api.provideThumbnail(y,({url:r,width:u,height:f,x:T,y:D})=>{try{const L=new VTTCue(y,R,`${r}#xywh=${T},${D},${u},${f}`);E(L)}catch(L){a(L)}})});g.push(b)}return await Promise.all(g).catch(v=>console.error("Error processing thumbnails",v))},{totalThumbnails:n,thumbnailDuration:o}=K(e),l=await s(n,o);let c=this.nativeEl.querySelector('track[label="thumbnails"]');if(!c){c=z(),this.nativeEl.appendChild(c);const d=V(l);c.src=d,c.dispatchEvent(new Event("change"))}}async load(){if(A(this,_)){this.api.attachSource(this.src);return}C(this,_,!0);const e=await W(()=>import("./dash.all.min-DKkwckr9.js"),[]);this.api=e.MediaPlayer().create(),this.api.initialize(this.nativeEl,this.src,this.autoplay),this.api.on(e.MediaPlayer.events.STREAM_INITIALIZED,()=>{const s=this.api.getRepresentationsByType("video");let n=this.videoTracks.getTrackById("main");n||(n=this.addVideoTrack("main"),n.id="main",n.selected=!0),s.forEach(o=>{const l=o.bandwidth??o.bitrate??(Number.isFinite(o.bitrateInKbit)?o.bitrateInKbit*1e3:void 0),c=n.addRendition(o.id,o.width,o.height,o.mimeType??o.codec,l);c.id=o.id}),this.videoRenditions.addEventListener("change",()=>{const o=this.videoRenditions[this.videoRenditions.selectedIndex];o!=null&&o.id?(this.api.updateSettings({streaming:{abr:{autoSwitchBitrate:{video:!1}}}}),this.api.setRepresentationForTypeById("video",o.id,!0)):this.api.updateSettings({streaming:{abr:{autoSwitchBitrate:{video:!0}}}})}),this.api.isDynamic()||this.api.getRepresentationsByType("image").forEach(async(l,c)=>{c>0||this._initThumbnails(l)})})}}_=new WeakMap,k(S,"shadowRootOptions",{...P.shadowRootOptions}),k(S,"getTemplateHTML",e=>{const{src:s,...n}=e;return P.getTemplateHTML(n)});function K(t){var i,e;const s=t.essentialProperties[0],[n,o]=s.value.split("x").map(Number),l=n*o,c=((e=(i=t.adaptation)==null?void 0:i.period)==null?void 0:e.duration)||null,d=t.segmentDuration,p=t.timescale||1,m=d/p/l;return{totalThumbnails:c!=null?Math.ceil(c/m):Math.ceil(d/m),thumbnailDuration:m}}function q({thIndex:t,tduration:i,thduration:e,ttiles:s,startNumber:n,pto:o}){const l=Math.floor(t/s)+n,c=t%s+1,d=(l-1)*i-o,p=(c-1)*e;return d+p}function z(){const t=document.createElement("track");return t.kind="metadata",t.label="thumbnails",t.srclang="en",t.mode="hidden",t.default=!0,t}function V(t){let i=`WEBVTT

`;for(const n of t)i+=`${s(n.startTime)} --> ${s(n.endTime)}
`,i+=`${n.text}

`;const e=new Blob([i],{type:"text/vtt"});return URL.createObjectURL(e);function s(n){const o=String(Math.floor(n/3600)).padStart(2,"0"),l=String(Math.floor(n%3600/60)).padStart(2,"0"),c=(n%60).toFixed(3).padStart(6,"0");return`${o}:${l}:${c}`}}globalThis.customElements&&!globalThis.customElements.get("dash-video")&&globalThis.customElements.define("dash-video",S);var Z=S,G=new Set(["style","children","ref","key","suppressContentEditableWarning","suppressHydrationWarning","dangerouslySetInnerHTML"]),J={className:"class",htmlFor:"for"};function B(t){return t.toLowerCase()}function O(t){if(typeof t=="boolean")return t?"":void 0;if(typeof t!="function"&&!(typeof t=="object"&&t!==null))return t}function Q({react:t,tagName:i,elementClass:e,events:s,displayName:n,defaultProps:o,toAttributeName:l=B,toAttributeValue:c=O}){const d=Number.parseInt(t.version)>=19,p=t.forwardRef((g,m)=>{var w,M;const h=t.useRef(null),v=t.useRef(new Map),y={},R={},b={},E={};for(const[a,r]of Object.entries(g)){if(G.has(a)){b[a]=r;continue}const u=l(J[a]??a);if(e.prototype&&a in e.prototype&&!(a in(((w=globalThis.HTMLElement)==null?void 0:w.prototype)??{}))&&!((M=e.observedAttributes)!=null&&M.some(T=>T===u))){E[a]=r;continue}if(a.startsWith("on")){y[a]=r;continue}const f=c(r);if(u&&f!=null&&(R[u]=String(f),d||(b[u]=f)),u&&d){const T=O(r);f!==T?b[u]=f:b[u]=r}}if(typeof window<"u"){for(const a in y){const r=y[a],u=a.endsWith("Capture"),f=((s==null?void 0:s[a])??a.slice(2).toLowerCase()).slice(0,u?-7:void 0);t.useLayoutEffect(()=>{const T=h==null?void 0:h.current;if(!(!T||typeof r!="function"))return T.addEventListener(f,r,u),()=>{T.removeEventListener(f,r,u)}},[h==null?void 0:h.current,r])}t.useLayoutEffect(()=>{if(h.current===null)return;const a=new Map;for(const r in E)x(h.current,r,E[r]),v.current.delete(r),a.set(r,E[r]);for(const[r,u]of v.current)x(h.current,r,void 0);v.current=a})}if(typeof window>"u"&&(e!=null&&e.getTemplateHTML)&&(e!=null&&e.shadowRootOptions)){const{mode:a,delegatesFocus:r}=e.shadowRootOptions,u=t.createElement("template",{shadowrootmode:a,shadowrootdelegatesfocus:r,dangerouslySetInnerHTML:{__html:e.getTemplateHTML(R,g)}});b.children=[u,b.children]}return t.createElement(i,{...o,...b,ref:t.useCallback(a=>{h.current=a,typeof m=="function"?m(a):m!==null&&(m.current=a)},[m])})});return p.displayName=n??e.name,p}function x(t,i,e){var s;t[i]=e,e==null&&i in(((s=globalThis.HTMLElement)==null?void 0:s.prototype)??{})&&t.removeAttribute(i)}var et=Q({react:U,tagName:"dash-video",elementClass:Z,toAttributeName(t){return t==="muted"?"":t==="defaultMuted"?"muted":B(t)}});/*! Bundled license information:

ce-la-react/dist/ce-la-react.js:
  (**
   * @license
   * Copyright 2018 Google LLC
   * SPDX-License-Identifier: BSD-3-Clause
   *
   * Modified version of `@lit/react` for vanilla custom elements with support for SSR.
   *)
*/export{et as default};
